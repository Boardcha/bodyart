var totalWithoutShipping=0,salesTax=0,shippingWeight=0,free_items_count=0;function calcAllTotals(e){$(".checkout_button").hide();var f=$('input[name="shipping-option"]:checked').val();$(".cart_grand-total").html('<i class="fa fa-spinner fa-spin"></i> Calculating');var d=location.pathname.substring(location.pathname.lastIndexOf("/")+1),m="",t="",s="",a="",i="",a=$("input:radio[name='cim_shipping']").is(":checked")&&$("#cim_shipping_addresses").is(":visible")?(m=$("input[name='cim_shipping']:checked").attr("data-country"),t=$("input[name='cim_shipping']:checked").attr("data-state"),s=$("input[name='cim_shipping']:checked").attr("data-zip"),$("input[name='cim_shipping']:checked").attr("data-address")):(m=$("select[name='shipping-country']").val(),t=$("select[name='shipping-state']").val(),s=$("input[name='shipping-zip']").val(),$("input[name='shipping-address']").val()+" "+$("input[name='shipping-address2']").val());"AR"!==t&&"CA"!==t&&"CO"!==t&&"FL"!==t&&"GA"!==t&&"HI"!==t&&"IL"!==t&&"IN"!==t&&"IA"!==t&&"KS"!==t&&"KY"!==t&&"LA"!==t&&"MA"!==t&&"ME"!==t&&"MD"!==t&&"MI"!==t&&"MN"!==t&&"NE"!==t&&"NV"!==t&&"NJ"!==t&&"NC"!==t&&"OH"!==t&&"OK"!==t&&"PA"!==t&&"RI"!==t&&"SD"!==t&&"TX"!==t&&"UT"!==t&&"VA"!==t&&"VT"!==t&&"WA"!==t&&"WV"!==t||(i="yes"),$.ajax({type:"post",async:!1,url:"cart/inc_cart_totals.asp",dataType:"json",data:{shipping_option:f,page_name:d,tax_country:m,tax_state:t,tax_zip:s,tax_address:a,state_taxed:i},success:function(e){var t,s,a,i,r,o,n,l,c,p;0<e.subtotal?$("#cim_billing_addresses").show():$("#cim_billing_addresses").hide(),subTotal=parseFloat(e.subtotal),totalDiscount=parseFloat(e.total_discount),salesTax=e.salestax,$(".cart_subtotal").html(e.subtotal),$(".cart_grand-total").html(e.grandtotal),$(".convert-total").attr("data-price",e.grandtotal),"$0.00"!=e.retail_delivery_fee?($(".retail_delivery_fee").html(e.retail_delivery_fee),$(".row_retail_delivery_fee").show()):$(".row_retail_delivery_fee").hide(),$(".cart_sales-tax").html(e.salestax_without_delivery_fee),$(".cart_coupon-amt").html(e.couponamt),$(".cart_prefferred_discount").html(e.preferred_discount),$(".shipping_amount_left").html(e.shippingneeded),$(".cart_shipping").html(e.shippingfriendly),$("#cart_gift-cert").html(e.var_total_giftcert_used),$("#store_credit_amt").html(e.store_credit_amt),$("#use_now_amount").html(e.use_now_credits),shippingWeight=e.weight,preOrderItem=e.pre_order_item,"USA"===m?$(".cart_sales-tax-state").html(e.salestax_state+" "):$(".cart_sales-tax-state").html(""),"USD"!=Cookies.get("currency")?updateCurrency():$(".row_convert_total").hide(),void 0!==f&&$(".checkout_button").show(),"cart.asp"!==d&&"cart2.asp"!==d||($(".checkout_button").show(),35<=e.grandtotal&&$("#btn-afterpay-checkout, .checkout_afterpay").show(),e.grandtotal<=0&&($(".payment-options").html("STORE CREDIT"),$(".checkout_paypal, #btn-afterpay-checkout, .checkout_afterpay, #btn-googlepay, #btn-applepay").hide())),"$0.00"==e.use_now_credits?$("#row_use_now_credits").hide():$("#row_use_now_credits").show(),"$0.00"==e.var_total_giftcert_used?$("#row_gift_cert").hide():$("#row_gift_cert").show(),"$0.00"==e.store_credit_amt?$("#row_store_credit").hide():$("#row_store_credit").show(),$("#cim_cash, #cash").is(":checked")||(e.grandtotal<=0?($(".billing-information").fadeOut(500),$("#cash").prop("checked",!1),$("#paypal").prop("checked",!1),$('input[name="cim_billing"]:first').trigger("click"),toggleRequiredBillingFalse()):"on"===$("#paypal-checkout").val()?($(".billing-information").hide(),$(".billing-information :input").prop("disabled",!0)):($(".billing-information").fadeIn(1e3),toggleRequiredBillingTrue())),1==e.var_other_items?(Cookies.set("orings","",{expires:30}),e.subtotal_after_discounts<=50?$(".cart_shipping_amountLeft").show():$(".cart_shipping_amountLeft").hide(),c=e.fraudcheck_freegifts_subtotal,free_items_count=7,t=freeGiftText="",c<150&&(free_items_count=6,amountToGetAnotherGift=150-c,freeGiftText="You've got <b>$"+amountToGetAnotherGift.toFixed(2)+"</b> to go to get another free gift!",clearFreeItemsCookie(7)),c<100&&(free_items_count=5,amountToGetAnotherGift=100-c,freeGiftText="You've got <b>$"+amountToGetAnotherGift.toFixed(2)+"</b> to go to get another free gift!",clearFreeItemsCookie(6)),c<75&&(free_items_count=4,amountToGetAnotherGift=75-c,freeGiftText="You've got <b>$"+amountToGetAnotherGift.toFixed(2)+"</b> to go to get another free gift!",clearFreeItemsCookie(5)),c<50&&(free_items_count=3,amountToGetAnotherGift=50-c,freeGiftText="You've got <b>$"+amountToGetAnotherGift.toFixed(2)+"</b> to go to get another free gift!",clearFreeItemsCookie(4)),c<30&&(free_items_count=2,amountToGetAnotherGift=30-c,freeGiftText="You've got <b>$"+amountToGetAnotherGift.toFixed(2)+"</b> to go to earn a free gift!",t="Unlocked: O-rings & Stickers",clearFreeItemsCookie(3)),0<free_items_count&&(2<free_items_count&&(t="Unlocked: "+(free_items_count-2)+" free gift"+(1<free_items_count?"s":"")+"!"),p=l=o=i=s="fa-lock",c=e=n=r=a="icon-bg-gray",2<free_items_count&&(s="fa-check",a="icon-bg-blue"),3<free_items_count&&(i="fa-check",r="icon-bg-blue"),4<free_items_count&&(o="fa-check",n="icon-bg-blue"),5<free_items_count&&(l="fa-check",e="icon-bg-blue"),6<free_items_count&&(p="fa-check",c="icon-bg-blue"),p='<div class="stepper-container"><div id="free-items-stepper-info" class="text-uppercase text-center font-weight-bold p-1 mt-2"> <span id="free-items-stepper-subtitle">'+t+' <br /><div class="mt-1"><a  href="#" class="btn btn-outline-primary font-weight-bold btn-free-items" data-toggle="modal" data-target="#free-items-modal"><i class="fa fa-gift fa-lg mr-1"></i>SELECT YOUR FREE ITEMS</a></span></span></div></span></div><div id="free-items-stepper-title" class="text-uppercase text-center font-weight-bold pt-2 mt-2">'+freeGiftText+'</div><div class="k-widget free-items-stepper free-items-stepper-linear mt-2"><ol class="free-items-step-list free-items-step-list-horizontal"><li class="free-items-step free-items-step-current free-items-step-focus free-items-step-first free-items-step-done free-items-step-success" style="width: 16.6666%;"><a href="#" class="btn-free-items free-items-step-link" data-toggle="modal" data-target="#free-items-modal" title="Select your free gifts" role="tab" aria-controls="wizard-0" aria-selected="false"><span class="free-items-step-indicator icon-bg-blue" aria-hidden="true"><span class="free-items-step-indicator-icon k-icon fa fa-check"></span></span><span class="free-items-step-label"><span class="free-items-step-text"></span> </span></a></li><li class="free-items-step free-items-step-current free-items-step-focus" style="width: 16.6666%;"><a href="#" class="btn-free-items free-items-step-link" data-toggle="modal" data-target="#free-items-modal" title="Select your free gifts" role="tab" aria-controls="wizard-1" aria-selected="true" aria-current="true"><span class="free-items-step-indicator '+a+'" aria-hidden="true"><span class="step2-icon free-items-step-indicator-icon k-icon fa '+s+'"></span></span><span class="free-items-step-label"><span class="free-items-step-text"></span> </span></a></li><li class="free-items-step free-items-step-current free-items-step-focus" style="width: 16.6666%;"><a href="#" class="btn-free-items free-items-step-link" data-toggle="modal" data-target="#free-items-modal" title="Select your free gifts" role="tab" aria-controls="wizard-2" aria-selected="false" tabindex="-1"><span class="free-items-step-indicator '+r+'" aria-hidden="true"><span class="step3-icon free-items-step-indicator-icon k-icon fa '+i+'"></span></span><span class="free-items-step-label"><span class="free-items-step-text"></span> </span></a></li><li class="free-items-step free-items-step-current free-items-step-focus" style="width: 16.6666%;"><a href="#" class="btn-free-items free-items-step-link" data-toggle="modal" data-target="#free-items-modal" title="Select your free gifts" role="tab" aria-controls="wizard-2" aria-selected="false" tabindex="-1"><span class="free-items-step-indicator '+n+'" aria-hidden="true"><span class="step4-icon free-items-step-indicator-icon k-icon fa '+o+'"></span></span><span class="free-items-step-label"><span class="free-items-step-text"></span> </span></a></li><li class="free-items-step free-items-step-current free-items-step-focus" style="width: 16.6666%;"><a href="#" class="btn-free-items free-items-step-link" data-toggle="modal" data-target="#free-items-modal" title="Select your free gifts" role="tab" aria-controls="wizard-2" aria-selected="false" tabindex="-1"><span class="free-items-step-indicator '+e+'" aria-hidden="true"><span class="step5-icon free-items-step-indicator-icon k-icon fa '+l+'"></span></span><span class="free-items-step-label"><span class="free-items-step-text"></span> </span></a></li><li class="free-items-step free-items-step-current free-items-step-focus free-items-step-last" style="width: 16.6666%;"><a href="#" class="btn-free-items free-items-step-link" data-toggle="modal" data-target="#free-items-modal" title="Select your free gifts" role="tab" aria-controls="wizard-2" aria-selected="false" tabindex="-1"><span class="free-items-step-indicator '+c+'" aria-hidden="true"><span class="step6-icon free-items-step-indicator-icon k-icon fa '+p+'"></span></span><span class="free-items-step-label"><span class="free-items-step-text"></span> </span></a></li></ol><div data-role="progressbar" class="k-widget k-progressbar k-progressbar-horizontal k-pos-absolute k-overflow-hidden" style="position: absolute; margin-left: 25px;width: 100%;"><div class="k-state-selected" style="width: calc(100% - 50px);"></div></div><div class="text-center"><a style="color:#666;font-style: italic;font-size:15px;" href="#" data-toggle="modal" data-target="#free-items-page-modal">View our free gifts</a></div></div></div>',$("#stepper").html(p))):(free_items_count=0,$("#free-items-info").html(""),$("#stepper").html(""),clearFreeItemsCookie(1))}})}