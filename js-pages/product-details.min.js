function refreshMenu(){var productid=$("#productid").val(),gauge=$("#filter-gauge").val(),deferred=$.Deferred();return $("#select-addtocart").load("products/ajax-details-dropdown-addtocart.asp",{productid:productid,gauge:gauge},(function(){$("#select-addtocart").show(),$("#loading-addtocart").hide(),deferred.resolve()})),deferred.promise()}function updateSalePrice(){var qty=$('input[name="qty"]').val(),discount_amount=$('input[name="discount_amount"]').val(),actual_price=$(".add-cart:checked").attr("data-actual-price"),retail_price=$(".add-cart:checked").attr("data-retail-price"),sale_price=$(".add-cart:checked").attr("data-sale-price"),currency_symbol=$(".add-cart:checked").attr("data-symbol"),savings=parseFloat((retail_price-sale_price)*qty).toFixed(2),retail=parseFloat(retail_price*qty).toFixed(2);0!=sale_price&&null!=sale_price?$(".sale-info").html('<span class="mr-3 ">Savings: '+currency_symbol+savings+'</span><span class="mr-3">Retail <s>'+currency_symbol+retail+"</s></span>"):$(".sale-info").html("")}function resetbutton(){$(".add_to_cart").hide(),$(".add-cart-message").show().html("<div class='alert alert-success my-2 p-1'>Item has been added to your cart</div>"),$(".add-cart-message").delay(3e3).fadeOut("slow"),$(".add_to_cart").prop("disabled",!1),$(".add_to_cart").html('<i class="fa fa-shopping-cart fa-lg mr-3"></i>Add to cart'),$(".add_to_cart").delay(3500).fadeIn("slow",(function(){$(".add_to_cart").addClass("checkout_button"),$(".add_to_cart").removeClass("button_loading")}))}function showcart(){var page_name=location.pathname.substring(location.pathname.lastIndexOf("/")+1);$(".cart_show").fadeIn("fast"),$(".cart_show_frame").load("cart/inc_cart_display_mini.asp",{page_name:page_name}),$(".cart_show").delay(8e3).fadeOut("fast")}function run_cart_mobile(){var page_name=location.pathname.substring(location.pathname.lastIndexOf("/")+1);$(".cart_show_frame").load("cart/inc_cart_mobile_nodisplay.asp",{page_name:page_name})}function changebutton(){$(".add_to_cart").prop("disabled",!0),$(".add_to_cart").html("Adding item to cart <span class='dot-one'>.</span><span class='dot-two'>.</span><span class='dot-three'>.</span>"),$(".add_to_cart").fadeIn("slow",(function(){$(".add_to_cart").addClass("button_loading"),$(".add_to_cart").removeClass("checkout_button")}))}$("#filter-gauge").change((function(){$("#select-addtocart").hide(),$("#loading-addtocart").show(),refreshMenu().done((function(){updateSalePrice()}))})),$("#add-qty").change((function(){var_qty=$("#add-qty").val(),var_qty<=0&&$("#add-qty").val("1")})),$("#navmenu a").on("click",(function(e){e.preventDefault(),$(this).tab("show")})),$(".checkout_button").prop("type","button");var isMobile=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);function SlickCustomerPhotos(){$("#customer-photos").slick({slidesToShow:6,slidesToScroll:6,variableWidth:!0,prevArrow:'<div class="slider-arrow-prev"><i class="fa fa-chevron-circle-left fa-2x text-white pointer"></i></div>',nextArrow:'<div class="slider-arrow-next"><i class="fa fa-chevron-circle-right fa-2x text-white pointer"></i></div>',responsive:[{breakpoint:1920,settings:{slidesToShow:12,slidesToScroll:10}},{breakpoint:1600,settings:{slidesToShow:10,slidesToScroll:8}},{breakpoint:1024,settings:{slidesToShow:7,slidesToScroll:6}},{breakpoint:600,settings:{slidesToShow:5,slidesToScroll:4}},{breakpoint:480,settings:{slidesToShow:3,slidesToScroll:3}}]})}$(".add_to_cart").click((function(e){var form=$("#frm-add-cart");if(!1===form[0].checkValidity())e.preventDefault(),e.stopPropagation(),console.log("invalid form elements"),$(".add-cart-message").show().html("<div class='alert alert-danger my-2 p-1 font-weight-bold'>Quantity &amp; item selection required</div>"),$(".add-cart-message").delay(3e3).fadeOut("slow"),form[0].classList.add("was-validated");else{if(form[0].classList.remove("was-validated"),var_preorder6="",var_preorder7="",""!=$("[name='preorder_field6']").val()&&(var_preorder6=$.grep([$("[name='preorder_field6_label']").val()+$("[name='preorder_field6']").val()],Boolean).join(", ")),""!=$("[name='preorder_field7']").val()&&(var_preorder7=$.grep([$("[name='preorder_field7_label']").val()+$("[name='preorder_field7']").val()],Boolean).join(", ")),changebutton(),var_detailid=$(".add-cart:checked").val(),var_anodid=$(".add-anodization:checked").val(),var_qty=$("[name='qty']").val(),var_preorders=$.grep([$("textarea#preorders").val(),$("[name='preorder_field1_label']").val()+$("[name='preorder_field1']").val(),$("[name='preorder_field2_label']").val()+$("[name='preorder_field2']").val(),$("[name='preorder_field3_label']").val()+$("[name='preorder_field3']").val(),$("[name='preorder_field4_label']").val()+$("[name='preorder_field4']").val(),$("[name='preorder_field5_label']").val()+$("[name='preorder_field5']").val(),var_preorder6,var_preorder7],Boolean).join(", "),var_anodid>0&&(var_preorders=$(".add-anodization:checked").attr("data-title")),console.log(var_preorders),getCookie("cartCount")>0)var cart_count=$(".cart-count").html();else var cart_count=0;var customorder=$("#customorder").val();$(".cart-count").html(parseInt(cart_count)+parseInt(var_qty)),$.ajax({method:"POST",url:"cart/ajax_cart_add_item.asp",data:{DetailID:var_detailid,qty:var_qty,preorders:var_preorders,customorder:customorder,anodID:var_anodid}}).done((function(msg){isMobile?run_cart_mobile():showcart(),resetbutton(),Cookies.set("cartCount",parseInt(cart_count)+parseInt(var_qty),{expires:365})})),$.getJSON("https://pro.ip-api.com/json/?key=1FbdfMEofSriXRs&fields=countryCode,region,city",(function(){})).done((function(data){Cookies.set("ip-country",data.countryCode,{expires:365}),Cookies.set("ip-region",data.region,{expires:365}),Cookies.set("ip-city",data.city,{expires:365})}))}e.preventDefault()})),$(document).on("click",".img-thumb",(function(){var img_id=$(this).attr("data-id");$("#add-cart-menu label").show(),$("#msg-filtered-dropdown").html(""),null!=img_id&&0!=img_id&&($('#add-cart-menu label:not(".option_img_'+img_id+'")').hide(),$("#msg-filtered-dropdown").html('<span class="btn btn-sm btn-info ml-2" id="remove-filter"><i class="fa fa-undo-alt fa-flip-horizontal mr-2"></i>Reload all colors &amp; styles</span>'))})),$(document).on("click","#remove-filter",(function(e){$("#add-cart-menu label").show(),$("#msg-filtered-dropdown").html(""),e.stopPropagation()})),$(document).on("change",".add-cart",(function(event){var imgid=$(this).attr("data-img_id"),img_name=$("#img_thumb_"+imgid).attr("data-imgname"),data_index=$("#img_id_"+imgid).attr("data-slick-index"),selected_text=$(this).attr("dropdown-title");$("#selected-item").html(selected_text),0!=imgid&&$(".slider-main-image").slick("slickGoTo",data_index,!0)})),$(document).on("change",".add-anodization",(function(event){var selected_text=$(this).attr("dropdown-title");$("#selected-anodization").html(selected_text)})),$(document).on("click","#dropdownAddCart",(function(){$("#add-cart-menu .dropdown-menu").scrollTop(0),$(".dropdown-menu").animate({scrollTop:0},2e3)})),$(document).on("click",".btn-select-menu",(function(){$("#wishlist-category, #wishlist-priority").prop("selectedIndex",0),$(".wishlist-toggle").hide(),$(".link-add-wishlist").removeClass("btn-danger"),$(".link-add-wishlist").addClass("btn-outline-danger")})),$(".qty-add").click((function(){var current_value=parseInt($("input[name='qty']").val());$("input[name='qty']").val(current_value+1)})),$(".qty-deduct").click((function(){var current_value=parseInt($("input[name='qty']").val()),new_value;current_value-1>0&&$("input[name='qty']").val(current_value-1)})),updateSalePrice(),$(document).on("change",".add-cart, input[name='qty']",(function(){updateSalePrice()})),$(".select-currency").on("click",(function(event){$(".currency-menu").toggle()})),$(".currency-menu img").click((function(){var selected_currency=$(this).attr("data-currency"),selected_symbol=$(this).attr("data-symbol");$.ajax({type:"post",url:"/template/inc-set-currency.asp",data:{currency:selected_currency}}).done((function(msg){$(".ajax-currency").html(selected_symbol+" "+selected_currency),updateCurrency().done((function(){refreshMenu()}))}))})),$(".link-add-wishlist").click((function(){$(".wishlist-toggle").show()})),$(".toggle-threading").click((function(){$(".div-toggle-threading").fadeToggle()})),$(".link-add-wishlist").on("click",(function(event){$(".wishlist-message").html('<i class="fa fa-spinner fa-2x fa-spin"></i>').show(),$("#wishlist-category, #wishlist-priority").prop("selectedIndex",0),var_preorders=$.grep([$("textarea#preorders").val(),$("[name='preorder_field1_label']").val()+$("[name='preorder_field1']").val(),$("[name='preorder_field2_label']").val()+$("[name='preorder_field2']").val(),$("[name='preorder_field3_label']").val()+$("[name='preorder_field3']").val(),$("[name='preorder_field4_label']").val()+$("[name='preorder_field4']").val(),$("[name='preorder_field5_label']").val()+$("[name='preorder_field5']").val(),$("[name='preorder_field6_label']").val()+$("[name='preorder_field6']").val(),$("[name='preorder_field7_label']").val()+$("[name='preorder_field7']").val()],Boolean).join(", "),$.ajax({method:"post",url:"/wishlist/ajax-wishlist-add.asp",data:$("#frm-add-cart").serialize()+"&preorder_specs="+encodeURI(var_preorders.replace(/\&/g," and "))}).done((function(msg){$(".wishlist-message").html('<div class="alert alert-success p-1 my-2">Item has been added to your wishlist</div>'),$(".wishlist-message").delay(3e3).fadeOut(),$(".link-add-wishlist").removeClass("btn-outline-danger"),$(".link-add-wishlist").addClass("btn-danger")})).fail((function(msg){$(".wishlist-message").html('<div class="alert alert-danger p-1 my-2">Website error. Item did not add to wishlist. Please contact customer service if you continue to have issues.</div>'),$(".wishlist-message").delay(3e3).fadeOut()}))})),$("#wishlist-category, #wishlist-priority").on("change",(function(event){$(".wishlist-message").html('<i class="fa fa-spinner fa-2x fa-spin"></i>').show();var category=$('select[name="wishlist-category"]').val(),priority=$('select[name="priority"]').val();$.ajax({method:"post",url:"/wishlist/ajax-wishlist-update-item.asp",data:{category:category,priority:priority,session:"yes"}}).done((function(msg){$(".wishlist-message").html('<div class="alert alert-success p-1 my-2">Item has been updated</div>'),$(".wishlist-message").delay(3e3).fadeOut()})).fail((function(msg){$(".wishlist-message").html('<div class="alert alert-danger p-1 my-2">Website error. Update failed. Please contact customer service if you continue to have issues.</div>'),$(".wishlist-message").delay(3e3).fadeOut()}))})),$(".link-wishlist").on("click",(function(event){var id=$(this).attr("data-detailid"),productid=$(this).attr("data-productid");$(".message-outs").hide(),$(".message-outs-"+id).html('<i class="fa fa-spinner fa-2x fa-spin"></i>').show(),$.ajax({method:"post",url:"/wishlist/ajax-wishlist-add.asp",data:{"add-cart":id,productid:productid}}).done((function(msg){$(".message-outs-"+id).html('<div class="alert alert-success p-1 my-1">Item has been added to your wishlist</div>'),$(".message-outs-"+id).delay(3e3).fadeOut(),$(".add-wishlist-"+id).removeClass("btn-outline-danger"),$(".add-wishlist-"+id).addClass("btn-danger")})).fail((function(msg){$(".message-outs-"+id).html('<div class="alert alert-danger">Website error. Item did not add to wishlist. Please contact customer service if you continue to have issues.</div>'),$(".message-outs-"+id).delay(3e3).fadeOut()}))})),$(".link-waiting").on("click",(function(event){var detailid=$(this).attr("data-detailid");$(".btn-add-waiting").attr("data-detailid",detailid),$(".frm-add-waiting").show().appendTo(".add-waiting-"+detailid)})),$(".btn-add-waiting").on("click",(function(event){var detailid=$(this).attr("data-detailid");$(".frm-add-waiting").hide(),$(".message-outs-"+detailid).html('<i class="fa fa-spinner fa-2x fa-spin"></i>').show(),$.ajax({method:"post",url:"/products/ajax-add-waiting-list.asp",data:$("#frm-add-waiting").serialize()+"&"+$.param({detailid:detailid})}).done((function(msg){$(".message-outs-"+detailid).html('<div class="alert alert-success my-2 p-1">You have been added to the waiting list</div>'),$(".message-outs-"+detailid).delay(3e3).fadeOut()})).fail((function(msg){$(".message-outs-"+detailid).html('<div class="notice-red">Website error. Item did not add to the waiting list. Please contact customer service if you continue to have issues.</div>'),$(".message-outs-"+detailid).delay(3e3).fadeOut()}))})),$.fancybox.defaults.loop=!0,$(".slider-main-image").slick({slidesToShow:1,slidesToScroll:1,fade:!0,prevArrow:!1,nextArrow:!1}),$("#vert-thumb-carousel").slick({asNavFor:".slider-main-image",vertical:!0,verticalSwiping:!0,focusOnSelect:!0,prevArrow:'<i class="fa fa-chevron-up fa-lg p-1 btn-block btn btn-dark btn-sm rounded-0"></i>',nextArrow:'<i class="fa fa-chevron-down fa-lg p-1 btn-block btn btn-dark btn-sm rounded-0"></i>',responsive:[{breakpoint:3e3,settings:{slidesToShow:7,slidesToScroll:1}},{breakpoint:1920,settings:{slidesToShow:6,slidesToScroll:1}},{breakpoint:1600,settings:{slidesToShow:6,slidesToScroll:1}},{breakpoint:1024,settings:{slidesToShow:5,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:480,settings:{slidesToShow:3,slidesToScroll:3}}]}),$("#recents,#cross-selling").slick({slidesToShow:6,slidesToScroll:6,prevArrow:'<div class="slider-arrow-prev"><i class="fa fa-chevron-circle-left fa-2x text-white pointer"></i></div>',nextArrow:'<div class="slider-arrow-next"><i class="fa fa-chevron-circle-right fa-2x text-white pointer"></i></div>',responsive:[{breakpoint:3e3,settings:{slidesToShow:10,slidesToScroll:10}},{breakpoint:1024,settings:{slidesToShow:7,slidesToScroll:7}},{breakpoint:600,settings:{slidesToShow:5,slidesToScroll:5}},{breakpoint:480,settings:{slidesToShow:3,slidesToScroll:3}}]});var productid=$("#productid_num").attr("data-productid");$.ajax({method:"POST",url:"/gallery/ajax-photo-gallery.asp",data:{productid:productid}}).done((function(html){response=html,$("#customer-photo-loader").html(response),SlickCustomerPhotos()})),$(document).on("change","#filter_photos_gauge, #filter_photos_color",(function(){var productid=$("#productid_num").attr("data-productid"),type=$(this).attr("data-type"),filter=$(this).attr("data-filter"),gauge=$("#filter_photos_gauge").val(),color=$("#filter_photos_color").val(),replace=$(this).attr("data-replace"),keep=$(this).attr("id"),this_value=$(this).val();$("#customer-photo-loader").load("/gallery/ajax-photo-gallery.asp?productid="+productid+"&gauge="+gauge+"&color="+color,(function(){SlickCustomerPhotos()})),console.log("gauge: "+gauge+" ||  color: "+color+" ||  this value: "+this_value+" ||  type: "+type+" ||  filter: "+filter),$.ajax({method:"POST",url:"/products/ajax-change-select-menus-reviews-gallery.asp",data:{productid:productid,type:type,filter:filter,this_value:this_value,gauge:decodeURIComponent(gauge),color:decodeURIComponent(color)}}).done((function(html){response=html,"All"!=this_value?(console.log("refresh other menu"),$("#"+replace).children("option:not(:selected), optgroup").remove(),$("#"+replace).append(response)):(console.log("refresh current menu"),$("#"+keep).children("option:not(:selected), optgroup").remove(),$("#"+keep).append(response))}))})),$(document).on("click","#customer-photo-loader .page-link",(function(event){event.preventDefault();var photos_url=$(this).attr("href");console.log(photos_url),$("#customer-photo-loader").load("/gallery/ajax-photo-gallery.asp"+photos_url,(function(){SlickCustomerPhotos()}))}));var productid=$("#productid_num").attr("data-productid");$("#div_product_reviews").load("products/ajax_product_reviews.asp?productid="+productid),$(document).on("click","#div_product_reviews a",(function(event){event.preventDefault();var review_url=$(this).attr("href");$("#div_product_reviews").load("products/ajax_product_reviews.asp"+review_url)})),$(document).on("change","#filter_review_gauge, #filter_review_color",(function(){var productid=$("#productid_num").attr("data-productid"),gauge=$("#filter_review_gauge").val(),color=$("#filter_review_color").val(),replace=$(this).attr("data-replace"),keep=$(this).attr("id"),this_value=$(this).val(),type=$(this).attr("data-type"),filter=$(this).attr("data-filter");$("#div_product_reviews").load("products/ajax_product_reviews.asp?productid="+productid+"&gauge="+gauge+"&color="+color),console.log("gauge: "+gauge+" ||  color: "+color+" ||  this value: "+this_value+" ||  type: "+type+" ||  filter: "+filter),$.ajax({method:"POST",url:"/products/ajax-change-select-menus-reviews-gallery.asp",data:{productid:productid,type:type,filter:filter,this_value:this_value,gauge:decodeURIComponent(gauge),color:decodeURIComponent(color)}}).done((function(html){response=html,"All"!=this_value?(console.log("refresh other menu"),$("#"+replace).children("option:not(:selected), optgroup").remove(),$("#"+replace).append(response)):(console.log("refresh current menu"),$("#"+keep).children("option:not(:selected), optgroup").remove(),$("#"+keep).append(response))}))})),$(document).on("click",".hover-rating",(function(){var rating=$(this).attr("data-rating"),productid=$("#productid").val(),gauge=$("#filter_review_gauge").val(),color=$("#filter_review_color").val();$("#div_product_reviews").load("products/ajax_product_reviews.asp?productid="+productid+"&filter_rating="+rating+"&gauge="+gauge+"&color="+color)})),$(document).on("click","#show-mm",(function(event){Cookies.set("showmm","yes",{expires:365}),refreshMenu(),$("#show-mm").hide(),$("#hide-mm").show()})),$(document).on("click","#hide-mm",(function(event){Cookies.remove("showmm"),refreshMenu(),$("#show-mm").show(),$("#hide-mm").hide()})),$(document).ready((function(){$("#modal-report-photo").on("show.bs.modal",(function(event){$(this).find("#report-photo-label").html("Report this photo")})),$("#frmReportPhoto").submit((function(e){var form=$("#frmReportPhoto");if(!1===form[0].checkValidity())e.preventDefault(),e.stopPropagation(),console.log("invalid form elements");else{var imgSrc=$(".fancybox-slide--current .fancybox-image").attr("src"),imgCaption=$(".fancybox-caption").text();$("#report-photo-message").load("/emails/ajax_report_photo.asp",{comments:$("#report-photo-comments").val(),url:window.location.href,img_src:imgSrc,caption:imgCaption},(function(){window.setTimeout((function(){$("#report-photo-message").html("")}),5e3)}))}form[0].classList.add("was-validated"),e.preventDefault()}))}));