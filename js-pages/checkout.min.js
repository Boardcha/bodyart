function triggerShippingSelection(){$('input[name="shipping-option"]').prop("checked",!1),$('input[name="shipping-option"]:first').prop("checked",!0),$("#ajax-shipping-options label:first").addClass("focus active"),verify_shipmethod_selected()}function triggerShippingCalc(){calcAllTotals(),verify_shipmethod_selected()}function setCurrency(){$("input:radio[name='cim_shipping']").is(":checked")?currency_country=$("input[name='cim_shipping']:checked").attr("data-country"):currency_country=$("select[name='shipping-country']").val(),"Australia"===currency_country?currency_type="AUD":"Canada"===currency_country?currency_type="CAD":"Japan"===currency_country?currency_type="JPY":"New Zealand"===currency_country?currency_type="NZD":"Denmark"===currency_country?currency_type="DKK":"United Kingdom"===currency_country?currency_type="GBP":"Great Britain"===currency_country?currency_type="GBP":(currency_type="USD",currency_img="usa.png"),$.ajax({type:"post",url:"/template/inc-set-currency.asp",data:{currency:currency_type}})}function set_fields_by_country(){"USA"===$("#shipping-country").val()&&($(".shipping-state, .billing-state, .hide_usa_zip").show(),$(".shipping-province, .billing-province,  .shipping-province-canada, .billing-province-canada, .hide_inter_zip").hide(),$(".shipping-province, .billing-province,  .shipping-province-canada, .billing-province-canada, .hide_inter_zip").val("")),"Canada"===$("#shipping-country").val()&&($(".shipping-province-canada, .billing-province-canada, .hide_inter_zip").show(),$(".shipping-state, .billing-state, .shipping-province, .billing-province, .hide_usa_zip").hide(),$(".shipping-state, .billing-state, .shipping-province, .billing-province, .hide_usa_zip").val("")),"USA"!=$("#shipping-country").val()&&"Canada"!=$("#shipping-country").val()&&($(".hide_inter_zip, .shipping-province, .billing-province").show(),$(".shipping-state, .billing-state, .hide_usa_zip, .shipping-province-canada, .billing-province-canada").hide(),$(".shipping-state, .billing-state, .hide_usa_zip, .shipping-province-canada, .billing-province-canada").val(""))}if(""!=Cookies.get("OrderAddonsActive")&&($(".checkout_button, #paypal-button-container").show(),$(".submit_disabled").hide(),$(".submit_disabled").html("")),$("input[name='cim_shipping']").on("change click",(function(e){$("#shipping-loading").show(),$("#ajax-shipping-options, #message-shipping").html("");var var_cim_shipping=$("input[name='cim_shipping']:checked").val(),cim_address=$(this).attr("data-address"),cim_state=$(this).attr("data-state"),cim_country=$(this).attr("data-country"),cim_city=$(this).attr("data-city"),cim_zip=$(this).attr("data-zip");setCurrency(),$("#load_temps").load("checkout/inc_store_state_selection.asp",{state:cim_state},(function(){}));var page=$("#ajax-shipping-options");page.load("/checkout/ajax_display_shipping_usps.asp",{cim:var_cim_shipping,country:cim_country,zip:cim_zip,address:cim_address,city:cim_city,state:cim_state},(function(status){$.get("/checkout/ajax_display_shipping_ups.asp",{cim:var_cim_shipping,country:cim_country,address:cim_address,city:cim_city,state:cim_state,zip:cim_zip},(function(html,status){page.append(html),triggerShippingSelection(),calcAllTotals(),$("#shipping-loading").hide()}))}))})),$('input[name="e-mail"]').val(Cookies.get("e-mail")),$('input[name="shipping-first"]').val(Cookies.get("shipping-first")),$('input[name="shipping-last"]').val(Cookies.get("shipping-last")),$('input[name="shipping-company"]').val(Cookies.get("shipping-company")),$('input[name="shipping-address"]').val(Cookies.get("shipping-address")),$('input[name="shipping-address2"]').val(Cookies.get("shipping-address2")),$('input[name="shipping-city"]').val(Cookies.get("shipping-city")),$("#shipping-state").val(Cookies.get("shipping-state")),$('input[name="shipping-province"]').val(Cookies.get("shipping-province")),$('input[name="shipping-province-canada"]').val(Cookies.get("shipping-province-canada")),$('#shipping-country option[value="'+Cookies.get("shipping-country")+'"]').prop("selected",!0),$('#billing-country option[value="'+Cookies.get("billing-country")+'"]').prop("selected",!0),"USA"!=$("#shipping-country").val()&&$("#shipping-state").prop("required",!1),$('input[name="shipping-zip"]').val(Cookies.get("shipping-zip")),$('input[name="shipping-phone"]').val(Cookies.get("shipping-phone")),$('input[name="billing-first"]').val(Cookies.get("billing-first")),$('input[name="billing-last"]').val(Cookies.get("billing-last")),$('input[name="billing-company"]').val(Cookies.get("billing-company")),$('input[name="billing-address"]').val(Cookies.get("billing-address")),$('input[name="billing-address2"]').val(Cookies.get("billing-address2")),$('input[name="billing-city"]').val(Cookies.get("billing-city")),$("#billing-state").val(Cookies.get("billing-state")),$('input[name="billing-province"]').val(Cookies.get("billing-province")),$('input[name="billing-province-canada"]').val(Cookies.get("billing-province-canada")),$("#billing-zip").val(Cookies.get("billing-zip")),""!=$("input[name='cim_shipping']:checked").val()&&($('input[name="cim_shipping"]:first').trigger("click"),window.onbeforeunload=function(){window.scrollTo(0,0)}),$("#shipping-country").is(":visible")){var varcountry=$("#shipping-country").val(),varzip=$("#shipping-zip").val(),address=$("input[name='shipping-address']").val()+" "+$("input[name='shipping-address2']").val(),city=$("input[name='shipping-city']").val(),state=$("select[name='shipping-state']").val();setCurrency();var page=$("#ajax-shipping-options");page.load("/checkout/ajax_display_shipping_usps.asp",{country:varcountry,zip:varzip,address:address,city:city,state:state},(function(status){$("#shipping-loading").hide(),$.get("/checkout/ajax_display_shipping_ups.asp",{country:varcountry},(function(html,status){page.append(html),triggerShippingSelection(),calcAllTotals()}))}))}function verify_shipmethod_selected(){"yes"!=$("#gift_cert_only").val()&&($('input[name="shipping-option"]').is(":checked")?($(".submit_disabled").hide(),$(".submit_disabled").html("")):($(".place_order").hide(),$(".submit_disabled").show(),$(".submit_disabled").html("Please select a shipping method to continue checkout.<br/><br/>If you do not see any shipping options, please fill out the shipping address form entirely.")))}set_fields_by_country(),$("input, select").change((function(){"card_number"!=$(this).attr("name")&&"billing-year"!=$(this).attr("name")&&"billing-month"!=$(this).attr("name")&&Cookies.set($(this).attr("name"),$(this).val(),{expires:30})})),$(".shipping-same").show(),$(".shipping-section").show(),$(".edit-link").show(),$(".edit-link-billing").show(),$('input[data-checked="checked"]').prop("checked",!0),$("#checkout_form").submit((function(e){""===$('input[type="password"]').val()&&$(".create-password").hide(),$(".checkout_button, #msg-location-replace").hide(),$(".processing-message").show(),$(".processing-message").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Please wait ... PROCESSING ORDER</div>');var form=$("#checkout_form");if(!1===form[0].checkValidity()){var this_error="",all_required_errors="";$(".form-control:invalid").each((function(i,obj){null!=$(this).attr("data-friendly-error")&&(this_error="- "+$(this).attr("data-friendly-error")+"<br/>",all_required_errors+=this_error)})),$(".processing-message").html('<div class="alert alert-danger mt-2">Some fields that are required have not been filled out. Please fix the fields that are highlighted in red.<div class="small mt-2">'+all_required_errors+"</div></div>"),$(".checkout_button").show()}else console.log("processing order..."),$.ajax({method:"POST",dataType:"json",url:"checkout/ajax_process_payment.asp",data:$("#checkout_form").serialize()}).done((function(json,msg){"yes"===json.paypal&&"used_partial"!=json.store_credit&&"yes"!=json.covered_infull_giftcert?(console.log("Paypal ... transferring"),$(".processing-message").html('<div class="alert alert-success mt-2">Transferring you to PayPal. Please wait ...</div>'),$("#msg-location-replace").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Transferring you to PayPal. Please wait ...</div>').show(),window.location="/checkout-paypal-authnet-v1.asp?step=1"):"yes"===json.afterpay&&"used_partial"!=json.store_credit&&"yes"!=json.covered_infull_giftcert?(console.log("Afterpay ... transferring"),$(".processing-message").html('<div class="alert alert-success mt-2">Transferring you to AfterPay. Please wait ...</div>'),$("#msg-location-replace").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Transferring you to AfterPay. Please wait ...</div>').show(),$.ajax({method:"post",dataType:"json",url:"afterpay/afterpay-create-checkout.asp"}).done((function(json,msg){afterpay_token=json.afterpay_token,console.log(afterpay_token),AfterPay.initialize({countryCode:"US"}),AfterPay.redirect({token:afterpay_token})})).fail((function(json,msg){$(".checkout_button").show(),$(".processing-message").html('<div class="alert alert-danger mt-2">Afterpay processing error</div>')}))):"yes"===json.cash?(console.log("Cash order"),$("#msg-location-replace").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Finalizing cash order - Please wait ...</div>').show(),window.location="/checkout_final.asp"):"used_partial"===json.store_credit?(console.log("Store credit paid for order in full"),$("#msg-location-replace, .processing-message").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Finalizing order & store credit - Please wait ...</div>').show(),window.location="/checkout_final.asp"):"yes"===json.covered_infull_giftcert?(console.log("Gift certificate paid for order in full"),$("#msg-location-replace, .processing-message").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Finalizing order & gift certificate - Please wait ...</div>').show(),window.location="/checkout_final.asp"):"fail"===json.stock_status?($(".checkout_button").show(),$(".processing-message").html("").hide(),$(".stock-error").show(),$(".stock-error").load("/cart/inc_stock_display_notice.asp"),calcAllTotals()):"yes"===json.cc_approved?(console.log("Payment successful"),$("#msg-location-replace").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Finalizing payment - Please wait ...</div>').show(),window.location="/checkout_final.asp"):(console.log("Payment declined"),console.log("msg.responseText: "+msg.responseText),console.log("json.errorText: "+json.errorText),$(".checkout_button").show(),$(".processing-message").html('<div class="alert alert-danger mt-2">We are sorry but the merchant has declined your card. You have not been charged. <br/><br/>The reason they gave is <span class="font-weight-bold">'+json.cc_reason+"</span></div>"))})).fail((function(){$(".checkout_button").show(),$(".processing-message").html('<div class="alert alert-danger mt-2">Unfortunately our website is having trouble processing your order.<br/><br/>Please review your information and try again or feel free to contact us <a class="alert-link" href="/contact.asp">via e-mail</a> or by phone at (877) 223-5005.<br><br><strong>ERROR MESSAGE: Ajax Failure</strong><br>'+$("#timestamp").val()+"</div>")}));return form[0].classList.add("was-validated"),e.preventDefault(),!1})),$(".add-new-shipping-button").click((function(){$('input[name="cim_shipping"]').prop("checked",!1),$(".shipping-address-form input, .shipping-address-form select").attr("disabled",!1),$("#changing-shipping-header").html("Add a new"),$("#shipping-save-wrapper, #shipping-same-billing-wrapper").show(),$(".shipping-address-form").show(),$("#cancel-shipping-add").show(),$(".add-new-shipping-button").hide(),$("#shipping-status").val("add"),$("#cim_shipping_addresses, .checkout_button").hide(),set_fields_by_country(),$(".shipping-address-form input:visible, select:visible").each((function(){Cookies.get($(this).attr("name"))&&$(this).val(Cookies.get($(this).attr("name")))})),$("#ajax-shipping-options").html("")})),$(".add-new-billing-button").click((function(){$(".radio_billing").removeAttr("checked"),$("#cim_paypal, #cim_cash").prop("checked",!1),$('input[name="cim_billing"]').parent("div").removeClass("notice-grey"),$(".billing-address-form input, .billing-address-form select").attr("disabled",!1),$("#shipping-first-checkout").is(":visible")||$("#shipping-same-billing-wrapper").hide(),$("#card-save-wrapper").show(),toggleRequiredBillingTrue(),$(".shipping-address-form").is(":hidden")&&$(".shipping-same").hide(),$(".billing-address-form, #credit_card_inputs, .billing-input-fields").show(),$("#card-save").show(),$(".add-new-billing-button").hide(),$("#cancel-billing-add").show(),$("#billing-status").val("add"),$("#cim_billing_addresses").hide(),set_fields_by_country(),$(".billing-address-form input:visible, select:visible").each((function(){Cookies.get($(this).attr("name"))&&$(this).val(Cookies.get($(this).attr("name")))}))})),$("#cancel-shipping-add").click((function(){$('input[name="cim_shipping"]:radio:first').prop("checked",!0),$('input[name="cim_shipping"]:radio:first').trigger("click"),$(".shipping-address-form input, .shipping-address-form select").attr("disabled",!0),$(".shipping-address-form").find(":input").not(":button, :submit, :reset, :hidden").val(""),$(".shipping-address-form").hide(),$(".add-new-shipping-button, .checkout_button, #cim_shipping_addresses").show(),$("#cancel-shipping-add, .shipping-same").hide(),$("#changing-shipping-header").html("Add a new"),$(".shipping-address-form :input").removeClass("valid error"),$("#shipping-status").val(""),$(".shipping-address-form input:hidden, select:hidden").each((function(){localStorage[$(this).attr("name")]&&localStorage.removeItem($(this).attr("name"))})),$("#ajax-shipping-options").load("checkout/ajax_display_shipping_usps.asp",{cim:$("input[name='cim_shipping']:checked").val()},(function(){triggerShippingSelection(),calcAllTotals()}))})),$("#cancel-billing-add").click((function(){$('input[name="cim_billing"]:radio:first').prop("checked",!0),$('input[name="cim_billing"]:radio:first').parent("div").addClass("notice-grey"),$(".billing-address-form input, .billing-address-form select").attr("disabled",!0),$(".billing-address-form input, .billing-address-form select").attr("disabled",!0),$(".billing-address-form").find(":input").not(":button, :submit, :reset, :hidden").val(""),$(".billing-address-form").hide(),$(".add-new-billing-button").show(),$("#cancel-billing-add, #btn-save-credit-card").hide(),$(".billing-address-form :input").removeClass("valid error"),$("#billing-status").val(""),$("#cim_billing_addresses").show(),$(".billing-address-form input:hidden, select:hidden").each((function(){localStorage[$(this).attr("name")]&&localStorage.removeItem($(this).attr("name"))}))})),$(document).on("change",'input[name="shipping-option"]:radio',(function(){calcAllTotals(),verify_shipmethod_selected()})),$(document).on("change","#e-mail",(function(){guest_email=$("#e-mail").val(),$.ajax({method:"POST",url:"checkout/ajax-save-guest-email.asp",data:{email:guest_email}})}));var var_cim_shipping_pageLoad=$("input[name='cim_shipping']:checked").val(),cim_country_pageLoad=$("input[name='cim_shipping']:checked").attr("data-country"),cim_state_pageLoad=$("input[name='cim_shipping']:checked").attr("data-state"),cim_zip_pageLoad=$("input[name='cim_shipping']:checked").attr("data-zip"),cim_city_pageLoad=$("input[name='cim_shipping']:checked").attr("data-city");function GetCardType(number){$(".fa").hasClass("text-primary")&&$(".fa").removeClass("text-primary");var re=new RegExp("^4");if(null!=number.match(re))return $(".fa-cc-visa").addClass("text-primary"),"Visa";var re=new RegExp("^5");return null!=number.match(re)?($(".fa-cc-mastercard").addClass("text-primary"),"Mastercard"):(re=new RegExp("^3[47]"),null!=number.match(re)?($(".fa-cc-amex").addClass("text-primary"),"AMEX"):(re=new RegExp("^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)"),null!=number.match(re)?($(".fa-cc-discover").addClass("text-primary"),"Discover"):""))}$(".ups-ajax").load("checkout/ajax_display_shipping_ups.asp",{cim:var_cim_shipping_pageLoad,country:cim_country_pageLoad,city:cim_city_pageLoad,state:cim_state_pageLoad,zip:cim_zip_pageLoad}),$("input[name='cim_billing']").on("load change",(function(){var var_cim_billing=$("input[name='cim_billing']:checked").val()})),$(".edit-link").click((function(e){$(".shipping-address-form input, .shipping-address-form select").attr("disabled",!1),$("#shipping-status").val("update"),$("#shipping-save-wrapper, .add-new-shipping-button, #cim_shipping_addresses").hide(),$("#cancel-shipping-add").show();var edit_country=$(this).data("country"),edit_zip=$(this).data("zip");$(".shipping-address-form").show(),$("input[name='shipping-first']").val($(this).data("firstname")),$("input[name='shipping-last']").val($(this).data("lastname")),$("input[name='shipping-address']").val($(this).data("address")),$("input[name='shipping-address2']").val($(this).data("address2")),$("input[name='shipping-company']").val($(this).data("company")),$("input[name='shipping-city']").val($(this).data("city")),$("select[name='shipping-state']").val($(this).data("state")),$("select[name='shipping-province-canada']").val($(this).data("state")),$("input[name='shipping-province']").val($(this).data("state")),$("input[name='shipping-zip']").val($(this).data("zip")),$("select[name='shipping-country']").val($(this).data("country")),"USA"==edit_country&&($(".shipping-province-canada, .shipping-province").hide(),$(".shipping-province-canada, .shipping-province").val(""),$(".shipping-state").show(),$("#shipping-state").prop("required",!0),$("#shipping-province-canada, #shipping-province").prop("required",!1)),"Canada"==edit_country&&($("select[name='shipping-province-canada']").append("<option value="+$(this).data("state")+" selected>"+$(this).data("state")+"</option>"),$(".shipping-province-canada").show(),$(".shipping-state, .shipping-province").hide(),$(".shipping-state, .shipping-province").val(""),$("#shipping-province-canada").prop("required",!0),$("#shipping-state, #shipping-province").prop("required",!1)),"USA"!=edit_country&&"Canada"!=edit_country&&($("input[name='shipping-province']").val($(this).data("state")),$(".shipping-province").show(),$(".shipping-state, .shipping-province-canada").hide(),$(".shipping-state, .shipping-province-canada").val(""),$("#shipping-state, #shipping-province, #shipping-province-canada").prop("required",!1)),$("#ajax-shipping-options").load("checkout/ajax_display_shipping_usps.asp",{country:edit_country,zip:edit_zip},(function(){$('input[name="shipping-option"]:first').click(),calcAllTotals(),document.getElementById("shipping-card").scrollIntoView(!0)})),e.preventDefault()})),$("input[name='password_confirmation'], input[name='password']").change((function(){var account_email=$("#e-mail").val();$.ajax({method:"POST",dataType:"json",url:"accounts/ajax_check_duplicate_account.asp",data:{email:account_email}}).done((function(json,msg){"yes"==json.duplicate?($("#duplicate_account").show(),$("#duplicate_account").html("An account registered under the e-mail address "+account_email+" already exists."),$("input[name='password_confirmation'], input[name='password']").val("")):$("#duplicate_account").hide()})).fail((function(json,msg){console.log("fail")}))})),$(".edit-link-billing").click((function(){$(".billing-address-form input, .billing-address-form select").attr("disabled",!1),$("#billing-status").val("update"),$("#card-save-wrapper, #shipping-same-billing-wrapper, .add-new-billing-button, #cim_billing_addresses").hide(),$("#cancel-billing-add, #btn-save-credit-card").show();var edit_country=$(this).data("country");$(".billing-address-form").show(),$("#btn-save-credit-card").attr("data-id",$(this).data("id")),$("input[name='billing-first']").val($(this).data("firstname")),$("input[name='billing-last']").val($(this).data("lastname")),$("input[name='billing-address']").val($(this).data("address")),$("input[name='billing-address2']").val($(this).data("address2")),$("input[name='billing-company']").val($(this).data("company")),$("input[name='billing-city']").val($(this).data("city")),$("select[name='billing-state']").val($(this).data("state")),$("select[name='billing-province-canada']").val($(this).data("state")),$("input[name='billing-province']").val($(this).data("state")),$("input[name='billing-zip']").val($(this).data("zip")),$("select[name='billing-country']").val($(this).data("country")),"USA"==edit_country&&$("#billing-province-canada, #billing-province").val(""),"Canada"==edit_country&&($("select[name='billing-province-canada']").append("<option value="+$(this).data("state")+" selected>"+$(this).data("state")+"</option>"),$("#billing-state, #billing-province").val("")),"USA"!=edit_country&&"Canada"!=edit_country&&($("#billing-state, #billing-province-canada").val(""),$(".billing-state, .billing-province, .billing-province-canada").prop("required",!1))})),$("#btn-save-credit-card").click((function(){$("#spinner-update-billing").show(),$("#msg-update-billing").hide();var cim_id=$(this).attr("data-id"),first=$("#billing-first").val(),last=$("#billing-last").val(),address=$("#billing-address").val(),address2=$("#billing-address2").val(),city=$("#billing-city").val(),state=$("#billing-state").val(),province=$("#billing-province").val(),province_canada=$("#billing-province-canada").val(),zip=$("#billing-zip").val(),country=$("#billing-country").val(),card_number=$("#cardNumber").val(),cc_month=$("#creditCardMonth").val(),cc_year=$("#creditCardYear").val();$.ajax({method:"post",dataType:"json",url:"accounts/ajax-cim-update-address.asp",data:{type:"billing","cim-id":cim_id,card_number:card_number,"billing-month":cc_month,"billing-year":cc_year,first:first,last:last,address:address,address2:address2,city:city,state:state,province:province,province_canada:province_canada,zip:zip,country:country}}).done((function(json,msg,data){$("#spinner-update-billing").hide(),"success"==json.status?($('input[name="cim_billing"]:radio[value='+cim_id+"]").prop("checked",!0),$('input[name="cim_billing"]:radio[value='+cim_id+"]").trigger("click"),$(".billing-address-form input, .billing-address-form select").attr("disabled",!0),$(".billing-address-form input, .billing-address-form select").attr("disabled",!0),$(".billing-address-form").find(":input").not(":button, :submit, :reset, :hidden").val(""),document.getElementById("cardid_"+cim_id).textContent=card_number.slice(card_number.length-4),$(".billing-address-form, #cancel-billing-add").hide(),$(".add-new-billing-button, #cim_billing_addresses, #billing-msg-"+cim_id).show(),$("#billing-status").val(""),document.getElementById("billing-block-"+cim_id).scrollIntoView()):$("#msg-update-billing").html(json.reason).show()})).fail((function(json,msg,data){$("#spinner-update-billing").hide(),$("#msg-update-billing").html("Code error "+json.reason).show()}))})),$("input[name='shipping-same-billing']").change((function(){this.checked?($("#billing-first").val($("#shipping-first-checkout").val()),$("#billing-last").val($("#shipping-last-checkout").val()),$("#billing-address").val($("#shipping-address").val()),$("#billing-address2").val($("#shipping-address2").val()),$("#billing-city").val($("#shipping-city").val()),$("#billing-state").val($("#shipping-state").val()),$("#billing-province-canada").val($("select[name='shipping-province-canada']").val()),$("#billing-province").val($("input[name='shipping-province']").val()),$("#billing-zip").val($("#shipping-zip").val()),$("#billing-country").val($("select[name='shipping-country']").val()),$("#billing-first, #billing-last, #billing-address, #billing-address2, #billing-city, #billing-state, #billing-province-canada, #billing-province, #billing-zip, #billing-country").trigger("change")):($("input[name='billing-first']").val(""),$("input[name='billing-last']").val(""),$("input[name='billing-address']").val(""),$("input[name='billing-address2']").val(""),$("input[name='billing-city']").val(""),$("input[name='billing-state']").val(""),$("input[name='billing-zip']").val(""),$("input[name='billing-province']").val(""),$("input[name='billing-province-canada']").val(""))})),$("select[name='shipping-country'], input[name='shipping-city'], select[name='shipping-state'], select[name='shipping-province-canada'], input[name='shipping-province'], input[name='shipping-zip'], input[name='shipping-address'], input[name='shipping-address2']").on("change",(function(e){var varaddress=$("input[name='shipping-address']").val()+" "+$("input[name='shipping-address2']").val(),varcity=$("input[name='shipping-city']").val(),varstate=$("select[name='shipping-state']").val(),varcanada=$("select[name='shipping-province-canada']").val(),varprovince=$("input[name='shipping-province']").val(),varzip=$("input[name='shipping-zip']").val(),varcountry=$("select[name='shipping-country']").val();if($("#load_temps").load("checkout/inc_store_state_selection.asp",{state:varstate},(function(response,status,xhr){})),setCurrency(),"USA"==varcountry){var page=$("#ajax-shipping-options");page.load("/checkout/ajax_display_shipping_usps.asp",{country:"USA",zip:varzip,address:varaddress,city:varcity,state:varstate},(function(status){$("#shipping-loading").hide(),$.get("/checkout/ajax_display_shipping_ups.asp",{address:varaddress,country:"USA",city:varcity,state:varstate,zip:varzip,add:"yes"},(function(html,status){page.append(html),triggerShippingSelection(),calcAllTotals()}))})),$("#shipping-province-canada, #billing-province-canada, #shipping-province, #billing-province").val(""),$("#shipping-province-canada, #shipping-province").prop("required",!1),$("#shipping-state").prop("required",!0),$(".shipping-province-canada").hide(),$(".billing-province-canada").hide(),$(".shipping-state").show(),$(".billing-state").show(),$(".shipping-province").hide(),$(".billing-province").hide(),$(".hide_inter_zip").hide(),$(".hide_usa_zip").show(),$(".customs-notice").hide()}"Canada"==varcountry&&($("#ajax-shipping-options").load("/checkout/ajax_display_shipping_usps.asp",{country:"Canada"},(function(){triggerShippingSelection(),calcAllTotals()})),$("#shipping-state, #billing-state, #shipping-province, #billing-province").val(""),$("#shipping-province-canada").prop("required",!0),$("#shipping-state, #shipping-province").prop("required",!1),$(".shipping-province-canada, .billing-province-canada, .hide_inter_zip, .customs-notice").show(),$(".shipping-state").hide(),$(".billing-state").hide(),$(".shipping-province").hide(),$(".billing-province").hide(),$(".hide_usa_zip").hide()),"USA"!=varcountry&&"Canada"!=varcountry&&($("#ajax-shipping-options").load("/checkout/ajax_display_shipping_usps.asp",{country:varcountry},(function(){triggerShippingSelection(),calcAllTotals()})),$("#shipping-state, #billing-state, #shipping-province-canada, #billing-province-canada").val(""),$("#shipping-state, #shipping-province-canada").prop("required",!1),$(".shipping-province-canada").hide(),$(".billing-province-canada").hide(),$(".shipping-state").hide(),$(".billing-state").hide(),$(".shipping-province").show(),$(".billing-province").show(),$(".hide_inter_zip").show(),$(".hide_usa_zip").hide(),$(".customs-notice").show()),verify_shipmethod_selected(),e.preventDefault()})),$("select[name='billing-country']").change((function(){var varcountry=$("select[name='billing-country']").val();"USA"==varcountry&&($(".billing-province-canada").hide(),$(".billing-state").show(),$(".billing-province").hide(),$(".hide_inter_zip").hide(),$(".hide_usa_zip").show(),$(".customs-notice").hide()),"Canada"==varcountry&&($(".billing-province-canada").show(),$(".billing-state").hide(),$(".billing-province").hide(),$(".hide_inter_zip").show(),$(".hide_usa_zip").hide(),$(".customs-notice").show()),"USA"!=varcountry&&"Canada"!=varcountry&&($(".billing-province-canada").hide(),$(".billing-state").hide(),$(".billing-province").show(),$(".hide_inter_zip").show(),$(".hide_usa_zip").hide(),$(".customs-notice").show())})),$("#paypal").click((function(){$("#cash").prop("checked",!1)})),$("#cash").click((function(){$("#paypal").prop("checked",!1)})),$(document).on("click",".btn-group label, .shipping-method",(function(){var type=$(this).attr("data-type");$("."+type+" .btn-selected").html(""),$(".btn-selected",this).html('<i class="ml-2 fa fa-lg fa-check"></i>')})),$("#cash").click((function(){$("#cash").is(":checked")?(toggleRequiredBillingFalse(),$(".billing-input-fields").fadeOut(1e3),$("#credit_card_inputs").fadeOut(1e3)):(toggleRequiredBillingTrue(),$(".billing-input-fields").fadeIn(1e3),$("#credit_card_inputs").fadeIn(1e3))})),$("#cim_cash_click").click((function(){toggleRequiredBillingFalse(),$(".billing-input-fields").fadeOut(1e3),$("#credit_card_inputs").fadeOut(1e3)})),$("#cardNumber").keyup((function(){$("#cardType").html=GetCardType($("#cardNumber").val())})),$("#checkout-newsletter-signup").on("click",(function(){$("#checkout-newsletter-signup").is(":checked"),$.ajax({method:"post",dataType:"json",url:"/klaviyo/klaviyo-subscribe-newsletter.asp?email="+$("#e-mail").val()})}));