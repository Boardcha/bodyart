function triggerShippingSelection(){$('input[name="shipping-option"]').prop("checked",!1),$('input[name="shipping-option"]:first').prop("checked",!0),$("#ajax-shipping-options label:first").addClass("focus active"),verify_shipmethod_selected()}function triggerShippingCalc(){calcAllTotals(),verify_shipmethod_selected()}function setCurrency(){currency_country=$("input:radio[name='cim_shipping']").is(":checked")?$("input[name='cim_shipping']:checked").attr("data-country"):$("select[name='shipping-country']").val(),"Australia"===currency_country?currency_type="AUD":"Canada"===currency_country?currency_type="CAD":"Japan"===currency_country?currency_type="JPY":"New Zealand"===currency_country?currency_type="NZD":"Denmark"===currency_country?currency_type="DKK":"United Kingdom"===currency_country||"Great Britain"===currency_country?currency_type="GBP":(currency_type="USD",currency_img="usa.png"),$.ajax({type:"post",url:"/template/inc-set-currency.asp",data:{currency:currency_type}})}function set_fields_by_country(){"USA"===$("#shipping-country").val()&&($(".shipping-state, .billing-state, .hide_usa_zip").show(),$(".shipping-province, .billing-province,  .shipping-province-canada, .billing-province-canada, .hide_inter_zip").hide(),$(".shipping-province, .billing-province,  .shipping-province-canada, .billing-province-canada, .hide_inter_zip").val("")),"Canada"===$("#shipping-country").val()&&($(".shipping-province-canada, .billing-province-canada, .hide_inter_zip").show(),$(".shipping-state, .billing-state, .shipping-province, .billing-province, .hide_usa_zip").hide(),$(".shipping-state, .billing-state, .shipping-province, .billing-province, .hide_usa_zip").val("")),"USA"!=$("#shipping-country").val()&&"Canada"!=$("#shipping-country").val()&&($(".hide_inter_zip, .shipping-province, .billing-province").show(),$(".shipping-state, .billing-state, .hide_usa_zip, .shipping-province-canada, .billing-province-canada").hide(),$(".shipping-state, .billing-state, .hide_usa_zip, .shipping-province-canada, .billing-province-canada").val(""))}var varcountry,varzip,address,city,state,page;function verify_shipmethod_selected(){"yes"!=$("#gift_cert_only").val()&&($('input[name="shipping-option"]').is(":checked")?($(".submit_disabled").hide(),$(".submit_disabled").html("")):($(".place_order").hide(),$(".submit_disabled").show(),$(".submit_disabled").html("Please select a shipping method to continue checkout.<br/><br/>If you do not see any shipping options, please fill out the shipping address form entirely.")))}""!=Cookies.get("OrderAddonsActive")&&($(".checkout_button, #paypal-button-container").show(),$(".submit_disabled").hide(),$(".submit_disabled").html("")),$("input[name='cim_shipping']").on("change click",function(i){$("#shipping-loading").show(),$("#ajax-shipping-options, #message-shipping").html("");var e=$("input[name='cim_shipping']:checked").val(),a=$(this).attr("data-address"),n=$(this).attr("data-state"),s=$(this).attr("data-country"),t=$(this).attr("data-city"),l=$(this).attr("data-zip");setCurrency(),$("#load_temps").load("checkout/inc_store_state_selection.asp",{state:n},function(){});var p=$("#ajax-shipping-options");p.load("/checkout/ajax_display_shipping_usps.asp",{cim:e,country:s,zip:l,address:a,city:t,state:n},function(i){$.get("/checkout/ajax_display_shipping_ups.asp",{cim:e,country:s,address:a,city:t,state:n,zip:l},function(i,e){p.append(i),triggerShippingSelection(),calcAllTotals(),$("#shipping-loading").hide()})})}),$('input[name="e-mail"]').val(Cookies.get("e-mail")),$('input[name="shipping-first"]').val(Cookies.get("shipping-first")),$('input[name="shipping-last"]').val(Cookies.get("shipping-last")),$('input[name="shipping-company"]').val(Cookies.get("shipping-company")),$('input[name="shipping-address"]').val(Cookies.get("shipping-address")),$('input[name="shipping-address2"]').val(Cookies.get("shipping-address2")),$('input[name="shipping-city"]').val(Cookies.get("shipping-city")),$("#shipping-state").val(Cookies.get("shipping-state")),$('input[name="shipping-province"]').val(Cookies.get("shipping-province")),$('input[name="shipping-province-canada"]').val(Cookies.get("shipping-province-canada")),$('#shipping-country option[value="'+Cookies.get("shipping-country")+'"]').prop("selected",!0),$('#billing-country option[value="'+Cookies.get("billing-country")+'"]').prop("selected",!0),"USA"!=$("#shipping-country").val()&&$("#shipping-state").prop("required",!1),$('input[name="shipping-zip"]').val(Cookies.get("shipping-zip")),$('input[name="shipping-phone"]').val(Cookies.get("shipping-phone")),$('input[name="billing-first"]').val(Cookies.get("billing-first")),$('input[name="billing-last"]').val(Cookies.get("billing-last")),$('input[name="billing-company"]').val(Cookies.get("billing-company")),$('input[name="billing-address"]').val(Cookies.get("billing-address")),$('input[name="billing-address2"]').val(Cookies.get("billing-address2")),$('input[name="billing-city"]').val(Cookies.get("billing-city")),$("#billing-state").val(Cookies.get("billing-state")),$('input[name="billing-province"]').val(Cookies.get("billing-province")),$('input[name="billing-province-canada"]').val(Cookies.get("billing-province-canada")),$("#billing-zip").val(Cookies.get("billing-zip")),""!=$("input[name='cim_shipping']:checked").val()&&($('input[name="cim_shipping"]:first').trigger("click"),window.onbeforeunload=function(){window.scrollTo(0,0)}),$("#shipping-country").is(":visible")&&(varcountry=$("#shipping-country").val(),varzip=$("#shipping-zip").val(),address=$("input[name='shipping-address']").val()+" "+$("input[name='shipping-address2']").val(),city=$("input[name='shipping-city']").val(),state=$("select[name='shipping-state']").val(),setCurrency(),(page=$("#ajax-shipping-options")).load("/checkout/ajax_display_shipping_usps.asp",{country:varcountry,zip:varzip,address:address,city:city,state:state},function(i){$("#shipping-loading").hide(),$.get("/checkout/ajax_display_shipping_ups.asp",{country:varcountry},function(i,e){page.append(i),triggerShippingSelection(),calcAllTotals()})})),set_fields_by_country(),""!=$("#shipping-address").val()&&""!=$("#shipping-city").val()&&""!=$("#shipping-zip").val()&&""!=$("#shipping-country").val()&&""!=getShippingState()&&createAddressBubble("shipping"),$("input, select").change(function(){"card_number"!=$(this).attr("name")&&"billing-year"!=$(this).attr("name")&&"billing-month"!=$(this).attr("name")&&Cookies.set($(this).attr("name"),$(this).val(),{expires:30})}),$(".shipping-same").show(),$(".shipping-section").show(),$(".edit-link").show(),$(".edit-link-billing").show(),$('input[data-checked="checked"]').prop("checked",!0),$("#checkout_form").submit(function(i){""===$('input[type="password"]').val()&&$(".create-password").hide(),$(".checkout_button, #msg-location-replace").hide(),$(".processing-message").show(),$(".processing-message").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Please wait ... PROCESSING ORDER</div>'),console.log($("#shipping-country").val());var a,n,e=$("#checkout_form");return!1===e[0].checkValidity()?(n=a="",$(".form-control:invalid").each(function(i,e){null!=$(this).attr("data-friendly-error")&&(a="- "+$(this).attr("data-friendly-error")+"<br/>",n+=a)}),$(".processing-message").html('<div class="alert alert-danger mt-2">Some fields that are required have not been filled out. Please fix the fields that are highlighted in red.<div class="small mt-2">'+n+"</div></div>"),$(".checkout_button").show(),$("#shipping-address-container").show(),$("#billing-address-container").show(),$("#shipping-address-autocomplete").hide(),$("#billing-address-autocomplete").hide(),$("#selected-shipping-address").hide(),$("#selected-billing-address").hide()):(console.log("processing order..."),$.ajax({method:"POST",dataType:"json",url:"checkout/ajax_process_payment.asp",data:$("#checkout_form").serialize()}).done(function(i,e){"yes"===i.paypal&&"used_partial"!=i.store_credit&&"yes"!=i.covered_infull_giftcert?(console.log("Paypal ... transferring"),$(".processing-message").html('<div class="alert alert-success mt-2">Transferring you to PayPal. Please wait ...</div>'),$("#msg-location-replace").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Transferring you to PayPal. Please wait ...</div>').show(),window.location="/checkout-paypal-authnet-v1.asp?step=1"):"yes"===i.afterpay&&"used_partial"!=i.store_credit&&"yes"!=i.covered_infull_giftcert?(console.log("Afterpay ... transferring"),$(".processing-message").html('<div class="alert alert-success mt-2">Transferring you to AfterPay. Please wait ...</div>'),$("#msg-location-replace").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Transferring you to AfterPay. Please wait ...</div>').show(),$.ajax({method:"post",dataType:"json",url:"afterpay/afterpay-create-checkout.asp"}).done(function(i,e){afterpay_token=i.afterpay_token,console.log(afterpay_token),AfterPay.initialize({countryCode:"US"}),AfterPay.redirect({token:afterpay_token})}).fail(function(i,e){$(".checkout_button").show(),$(".processing-message").html('<div class="alert alert-danger mt-2">Afterpay processing error</div>')})):"yes"===i.cash?(console.log("Cash order"),$("#msg-location-replace").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Finalizing cash order - Please wait ...</div>').show(),window.location="/checkout_final.asp"):"used_partial"===i.store_credit?(console.log("Store credit paid for order in full"),$("#msg-location-replace, .processing-message").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Finalizing order & store credit - Please wait ...</div>').show(),window.location="/checkout_final.asp"):"yes"===i.covered_infull_giftcert?(console.log("Gift certificate paid for order in full"),$("#msg-location-replace, .processing-message").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Finalizing order & gift certificate - Please wait ...</div>').show(),window.location="/checkout_final.asp"):"fail"===i.stock_status?($(".checkout_button").show(),$(".processing-message").html("").hide(),$(".stock-error").show(),$(".stock-error").load("/cart/inc_stock_display_notice.asp"),calcAllTotals()):"yes"===i.cc_approved?(console.log("Payment successful"),$("#msg-location-replace").html('<div class="alert alert-success mt-2"><i class="fa fa-spinner fa-2x fa-spin"></i> Finalizing payment - Please wait ...</div>').show(),window.location="/checkout_final.asp"):(console.log("Payment declined"),console.log("msg.responseText: "+e.responseText),console.log("json.errorText: "+i.errorText),$(".checkout_button").show(),$(".processing-message").html('<div class="alert alert-danger mt-2">We are sorry but the merchant has declined your card. You have not been charged. <br/><br/>The reason they gave is <span class="font-weight-bold">'+i.cc_reason+"</span></div>"))}).fail(function(){$(".checkout_button").show(),$(".processing-message").html('<div class="alert alert-danger mt-2">Unfortunately our website is having trouble processing your order.<br/><br/>Please review your information and try again or feel free to contact us <a class="alert-link" href="/contact.asp">via e-mail</a> or by phone at (877) 223-5005.<br><br><strong>ERROR MESSAGE: Ajax Failure</strong><br>'+$("#timestamp").val()+"</div>")})),e[0].classList.add("was-validated"),i.preventDefault(),!1}),$(".add-new-shipping-button").click(function(){$('input[name="cim_shipping"]').prop("checked",!1),$(".shipping-address-form input, .shipping-address-form select").attr("disabled",!1),$("#changing-shipping-header").html("Add a new"),$("#shipping-save-wrapper, #shipping-same-billing-wrapper").show(),$(".shipping-address-form").show(),$("#cancel-shipping-add").show(),$(".add-new-shipping-button").hide(),$("#shipping-status").val("add"),$("#cim_shipping_addresses, .checkout_button").hide(),set_fields_by_country(),$(".shipping-address-form input:visible:not(#shipping-full-address), select:visible").each(function(){Cookies.get($(this).attr("name"))&&$(this).val(Cookies.get($(this).attr("name")))}),$("#ajax-shipping-options").html("")}),$(".add-new-billing-button").click(function(){$(".radio_billing").removeAttr("checked"),$("#cim_paypal, #cim_cash").prop("checked",!1),$('input[name="cim_billing"]').parent("div").removeClass("notice-grey"),$(".billing-address-form input, .billing-address-form select").attr("disabled",!1),$("#shipping-first-checkout").is(":visible")||$("#shipping-same-billing-wrapper").hide(),$("#card-save-wrapper").show(),toggleRequiredBillingTrue(),$(".shipping-address-form").is(":hidden")&&$(".shipping-same").hide(),$(".billing-address-form, #credit_card_inputs, .billing-input-fields").show(),$("#card-save").show(),$(".add-new-billing-button").hide(),$("#cancel-billing-add").show(),$("#billing-status").val("add"),$("#cim_billing_addresses").hide(),set_fields_by_country(),$(".billing-address-form input:visible:not(#billing-full-address), select:visible").each(function(){Cookies.get($(this).attr("name"))&&$(this).val(Cookies.get($(this).attr("name")))})}),$("#cancel-shipping-add").click(function(){$('input[name="cim_shipping"]:radio:first').prop("checked",!0),$('input[name="cim_shipping"]:radio:first').trigger("click"),$(".shipping-address-form input, .shipping-address-form select").attr("disabled",!0),$(".shipping-address-form").find(":input").not(":button, :submit, :reset, :hidden").val(""),$(".shipping-address-form").hide(),$(".add-new-shipping-button, .checkout_button, #cim_shipping_addresses").show(),$("#cancel-shipping-add, .shipping-same").hide(),$("#changing-shipping-header").html("Add a new"),$(".shipping-address-form :input").removeClass("valid error"),$("#shipping-status").val(""),$(".shipping-address-form input:hidden, select:hidden").each(function(){localStorage[$(this).attr("name")]&&localStorage.removeItem($(this).attr("name"))}),$("#ajax-shipping-options").load("checkout/ajax_display_shipping_usps.asp",{cim:$("input[name='cim_shipping']:checked").val()},function(){triggerShippingSelection(),calcAllTotals()})}),$("#cancel-billing-add").click(function(){$('input[name="cim_billing"]:radio:first').prop("checked",!0),$('input[name="cim_billing"]:radio:first').parent("div").addClass("notice-grey"),$(".billing-address-form input, .billing-address-form select").attr("disabled",!0),$(".billing-address-form input, .billing-address-form select").attr("disabled",!0),$(".billing-address-form").find(":input").not(":button, :submit, :reset, :hidden").val(""),$(".billing-address-form").hide(),$(".add-new-billing-button").show(),$("#cancel-billing-add, #btn-save-credit-card").hide(),$(".billing-address-form :input").removeClass("valid error"),$("#billing-status").val(""),$("#cim_billing_addresses").show(),$(".billing-address-form input:hidden, select:hidden").each(function(){localStorage[$(this).attr("name")]&&localStorage.removeItem($(this).attr("name"))})}),$(document).on("change",'input[name="shipping-option"]:radio',function(){calcAllTotals(),verify_shipmethod_selected()}),$(document).on("change","#e-mail",function(){guest_email=$("#e-mail").val(),$.ajax({method:"POST",url:"checkout/ajax-save-guest-email.asp",data:{email:guest_email}})});var var_cim_shipping_pageLoad=$("input[name='cim_shipping']:checked").val(),cim_country_pageLoad=$("input[name='cim_shipping']:checked").attr("data-country"),cim_state_pageLoad=$("input[name='cim_shipping']:checked").attr("data-state"),cim_zip_pageLoad=$("input[name='cim_shipping']:checked").attr("data-zip"),cim_city_pageLoad=$("input[name='cim_shipping']:checked").attr("data-city");function getShippingState(){return("USA"==$("select[name='shipping-country']").val()?$("#shipping-state"):"Canada"==$("select[name='shipping-country']").val()?$("select[name='shipping-province-canada']"):$("input[name='shipping-province']")).val()}function getBillingState(){return("USA"==$("select[name='billing-country']").val()?$("#billing-state"):"Canada"==$("select[name='billing-country']").val()?$("select[name='billing-province-canada']"):$("input[name='billing-province']")).val()}function closeBillingBubble(){clearBillingAddressInputs(),$("#shipping-same-billing").prop("checked",!1),$("#billing-address-autocomplete").show(),$("#billing-full-address").val(""),$("#billing-full-address").focus(),console.log("close")}function clearAddressInputs(i){"billing"==i&&clearBillingAddressInputs(),"shipping"==i&&clearShippingAddressInputs()}function clearBillingAddressInputs(){$("input[name='billing-first']").val(""),$("input[name='billing-last']").val(""),$("input[name='billing-address']").val(""),$("input[name='billing-address2']").val(""),$("input[name='billing-city']").val(""),$("input[name='billing-state']").removeAttr("selected"),$("input[name='billing-country']").removeAttr("selected"),$("input[name='billing-zip']").val(""),$("input[name='billing-province']").val(""),$("input[name='billing-province-canada']").val("")}function clearShippingAddressInputs(){$("#shipping-full-address").val(""),$("input[name='shipping-address']").val(""),$("input[name='shipping-address2']").val(""),$("input[name='shipping-city']").val(""),$("input[name='shipping-country']").removeAttr("selected"),$("input[name='shipping-state']").removeAttr("selected"),$("input[name='shipping-province-canada']").removeAttr("selected"),$("input[name='shipping-province']").val(""),$("input[name='shipping-zip']").val("")}function GetCardType(i){$(".fa").hasClass("text-primary")&&$(".fa").removeClass("text-primary");var e=new RegExp("^4");if(null!=i.match(e))return $(".fa-cc-visa").addClass("text-primary"),"Visa";e=new RegExp("^5");return null!=i.match(e)?($(".fa-cc-mastercard").addClass("text-primary"),"Mastercard"):(e=new RegExp("^3[47]"),null!=i.match(e)?($(".fa-cc-amex").addClass("text-primary"),"AMEX"):(e=new RegExp("^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)"),null!=i.match(e)?($(".fa-cc-discover").addClass("text-primary"),"Discover"):""))}function createAddressBubble(i){var e="";"shipping"==i&&(e=getShippingState()),"billing"==i&&(e=getBillingState());e='<div class="alert alert-secondary alert-dismissible fade show" role="alert">  <div id="selected-'+i+'-address-content" class="m-2"><div class="mb-2 font-weight-bold">'+("shipping"==i?'<i class="fa fa-shipping-fast fa-lg mr-2"></i> ':"")+'<span style="text-transform: uppercase;">'+i+' ADDRESS</span></div><div style="line-height:22px;">'+($("#"+i+"-address").val()+" "+$("#"+i+"-address2").val()+"<br/>"+$("#"+i+"-city").val()+"<br/>"+$("#"+i+"-country").val()+"<br/>"+e+"<br/>"+$("#"+i+"-zip").val()+"")+'</div></div>  <button type="button"  class="close" id="btn-edit-'+i+'-address" style="right:20px;padding: 7px 11px 7px 11px;margin-right:16px">\t<img src="/images/edit.svg" style="height:14px;width:14px;vertical-align:initial;" />  </button>  <button id="'+i+'-bubble-close" type="button" class="close" data-dismiss="alert" aria-label="Close" style="padding: 7px 11px 7px 11px" onClick="$(\'#'+i+"-full-address').val('');$('#"+i+"-full-address').focus();clearAddressInputs('"+i+'\')">\t<span aria-hidden="true">&times;</span>  </button></div>';$("#selected-"+i+"-address").html(e),$("#selected-"+i+"-address").show(),$("#"+i+"-country").change(),$("input[name='shipping-same-billing']").is(":checked")&&"shipping"==i&&$("input[name='shipping-same-billing']").change()}$(".ups-ajax").load("checkout/ajax_display_shipping_ups.asp",{cim:var_cim_shipping_pageLoad,country:cim_country_pageLoad,city:cim_city_pageLoad,state:cim_state_pageLoad,zip:cim_zip_pageLoad}),$("input[name='cim_billing']").on("load change",function(){$("input[name='cim_billing']:checked").val()}),$(".edit-link").click(function(i){$(".shipping-address-form input, .shipping-address-form select").attr("disabled",!1),$("#shipping-status").val("update"),$("#shipping-save-wrapper, .add-new-shipping-button, #cim_shipping_addresses").hide(),$("#cancel-shipping-add").show();var e=$(this).data("country"),a=$(this).data("zip");$(".shipping-address-form").show(),$("input[name='shipping-first']").val($(this).data("firstname")),$("input[name='shipping-last']").val($(this).data("lastname")),$("input[name='shipping-address']").val($(this).data("address")),$("input[name='shipping-address2']").val($(this).data("address2")),$("input[name='shipping-company']").val($(this).data("company")),$("input[name='shipping-city']").val($(this).data("city")),$("select[name='shipping-state']").val($(this).data("state")),$("select[name='shipping-province-canada']").val($(this).data("state")),$("input[name='shipping-province']").val($(this).data("state")),$("input[name='shipping-zip']").val($(this).data("zip")),$("select[name='shipping-country']").val($(this).data("country")),"USA"==e&&($(".shipping-province-canada, .shipping-province").hide(),$(".shipping-province-canada, .shipping-province").val(""),$(".shipping-state").show(),$("#shipping-state").prop("required",!0),$("#shipping-province-canada, #shipping-province").prop("required",!1)),"Canada"==e&&($("select[name='shipping-province-canada']").append("<option value="+$(this).data("state")+" selected>"+$(this).data("state")+"</option>"),$(".shipping-province-canada").show(),$(".shipping-state, .shipping-province").hide(),$(".shipping-state, .shipping-province").val(""),$("#shipping-province-canada").prop("required",!0),$("#shipping-state, #shipping-province").prop("required",!1)),"USA"!=e&&"Canada"!=e&&($("input[name='shipping-province']").val($(this).data("state")),$(".shipping-province").show(),$(".shipping-state, .shipping-province-canada").hide(),$(".shipping-state, .shipping-province-canada").val(""),$("#shipping-state, #shipping-province, #shipping-province-canada").prop("required",!1)),""!=$("#shipping-address").val()&&""!=$("#shipping-city").val()&&""!=$("#shipping-zip").val()&&""!=$("#shipping-country").val()&&""!=getShippingState()?(createAddressBubble("shipping"),$("#shipping-address-container").hide(),$("#shipping-address-autocomplete").show()):($("#shipping-address-container").show(),$("#selected-shipping-address").hide(),$("#shipping-address-autocomplete").hide()),$("#ajax-shipping-options").load("checkout/ajax_display_shipping_usps.asp",{country:e,zip:a},function(){$('input[name="shipping-option"]:first').click(),calcAllTotals(),document.getElementById("shipping-card").scrollIntoView(!0)}),i.preventDefault()}),$("input[name='password_confirmation'], input[name='password']").change(function(){var a=$("#e-mail").val();$.ajax({method:"POST",dataType:"json",url:"accounts/ajax_check_duplicate_account.asp",data:{email:a}}).done(function(i,e){"yes"==i.duplicate?($("#duplicate_account").show(),$("#duplicate_account").html("An account registered under the e-mail address "+a+" already exists."),$("input[name='password_confirmation'], input[name='password']").val("")):$("#duplicate_account").hide()}).fail(function(i,e){console.log("fail")})}),$(".edit-link-billing").click(function(){$(".billing-address-form input, .billing-address-form select").attr("disabled",!1),$("#billing-status").val("update"),$("#card-save-wrapper, #shipping-same-billing-container, .add-new-billing-button, #cim_billing_addresses").hide(),$("#billing-address-autocomplete label").show(),$("#cancel-billing-add, #btn-save-credit-card").show();var i=$(this).data("country");$(".billing-address-form").show(),$("#btn-save-credit-card").attr("data-id",$(this).data("id")),$("input[name='billing-first']").val($(this).data("firstname")),$("input[name='billing-last']").val($(this).data("lastname")),$("input[name='billing-address']").val($(this).data("address")),$("input[name='billing-address2']").val($(this).data("address2")),$("input[name='billing-company']").val($(this).data("company")),$("input[name='billing-city']").val($(this).data("city")),$("select[name='billing-state']").val($(this).data("state")),$("select[name='billing-province-canada']").val($(this).data("state")),$("input[name='billing-province']").val($(this).data("state")),$("input[name='billing-zip']").val($(this).data("zip")),$("select[name='billing-country']").val($(this).data("country")),"USA"==i&&$("#billing-province-canada, #billing-province").val(""),"Canada"==i&&($("select[name='billing-province-canada']").append("<option value="+$(this).data("state")+" selected>"+$(this).data("state")+"</option>"),$("#billing-state, #billing-province").val("")),"USA"!=i&&"Canada"!=i&&($("#billing-state, #billing-province-canada").val(""),$(".billing-state, .billing-province, .billing-province-canada").prop("required",!1)),""!=$("#billing-address").val()&&""!=$("#billing-city").val()&&""!=$("#billing-zip").val()&&""!=$("#billing-country").val()&&""!=getBillingState()?(createAddressBubble("billing"),$("#billing-address-container").hide(),$("#billing-address-autocomplete").show()):($("#billing-address-container").show(),$("#selected-billing-address").hide(),$("#billing-address-autocomplete").hide())}),$("#btn-save-credit-card").click(function(){$("#spinner-update-billing").show(),$("#msg-update-billing").hide();var n=$(this).attr("data-id"),i=$("#billing-first").val(),e=$("#billing-last").val(),a=$("#billing-address").val(),s=$("#billing-address2").val(),t=$("#billing-city").val(),l=$("#billing-state").val(),p=$("#billing-province").val(),c=$("#billing-province-canada").val(),d=$("#billing-zip").val(),r=$("#billing-country").val(),o=$("#cardNumber").val(),g=$("#creditCardMonth").val(),h=$("#creditCardYear").val();$.ajax({method:"post",dataType:"json",url:"accounts/ajax-cim-update-address.asp",data:{type:"billing","cim-id":n,card_number:o,"billing-month":g,"billing-year":h,first:i,last:e,address:a,address2:s,city:t,state:l,province:p,province_canada:c,zip:d,country:r}}).done(function(i,e,a){$("#spinner-update-billing").hide(),"success"==i.status?($('input[name="cim_billing"]:radio[value='+n+"]").prop("checked",!0),$('input[name="cim_billing"]:radio[value='+n+"]").trigger("click"),$(".billing-address-form input, .billing-address-form select").attr("disabled",!0),$(".billing-address-form input, .billing-address-form select").attr("disabled",!0),$(".billing-address-form").find(":input").not(":button, :submit, :reset, :hidden").val(""),document.getElementById("cardid_"+n).textContent=o.slice(o.length-4),$(".billing-address-form, #cancel-billing-add").hide(),$(".add-new-billing-button, #cim_billing_addresses, #billing-msg-"+n).show(),$("#billing-status").val(""),document.getElementById("billing-block-"+n).scrollIntoView()):$("#msg-update-billing").html(i.reason).show()}).fail(function(i,e,a){$("#spinner-update-billing").hide(),$("#msg-update-billing").html("Code error "+i.reason).show()})}),$("input[name='shipping-same-billing']").change(function(){var i;this.checked?($("#billing-first").val($("#shipping-first-checkout").val()),$("#billing-last").val($("#shipping-last-checkout").val()),$("#billing-address").val($("#shipping-address").val()),$("#billing-address2").val($("#shipping-address2").val()),$("#billing-city").val($("#shipping-city").val()),$("#billing-state").val($("#shipping-state").val()),$("#billing-province-canada").val($("select[name='shipping-province-canada']").val()),$("#billing-province").val($("input[name='shipping-province']").val()),$("#billing-zip").val($("#shipping-zip").val()),$("#billing-country").val($("select[name='shipping-country']").val()),""!=$("#shipping-address").val()&&""!=$("#shipping-city").val()&&""!=$("#shipping-zip").val()&&""!=$("#shipping-country").val()&&""!=(i=getShippingState())?(i='<div class="alert alert-secondary alert-dismissible fade show" role="alert">  <div id="selected-billing-address-content" class="m-2"><div class="mb-2 font-weight-bold"><span style="text-transform: uppercase;">BILLING ADDRESS</span></div><div style="line-height:22px;">'+($("#shipping-address").val()+" "+$("#shipping-address2").val()+"<br />"+$("#shipping-city").val()+"<br />"+i+"<br />"+$("#shipping-zip").val()+"<br />"+$("select[name='shipping-country']").val())+'</div></div>  <button type="button"  class="close" id="btn-edit-billing-address" style="right:20px;padding: 7px 11px 7px 11px;margin-right:16px">\t<img src="/images/edit.svg" style="height:14px;width:14px;vertical-align:initial;" />  </button>  <button id="billing-bubble-close" type="button" class="close" data-dismiss="alert" aria-label="Close" style="padding: 7px 11px 7px 11px" onClick="closeBillingBubble()">\t<span aria-hidden="true">&times;</span>  </button></div>',$("#selected-billing-address").html(i),$("#selected-billing-address").hide().fadeIn("fast"),$("#billing-country").change(),$("#billing-address-autocomplete").hide(),$("#billing-address-container").hide()):($("#billing-address-container").show(),$("#selected-billing-address").hide(),$("#billing-address-autocomplete").hide()),$("#billing-first, #billing-last, #billing-address, #billing-address2, #billing-city, #billing-state, #billing-province-canada, #billing-province, #billing-zip, #billing-country").trigger("change"),$("#chk-billing-manual-address-input-container").hide()):(clearBillingAddressInputs(),$("#billing-bubble-close").trigger("click"),$("#billing-address-autocomplete").show(),$("#billing-address-container").hide(),$("#chk-billing-manual-address-input-container").show())}),$("input[name='chk-billing-manual-address-input']").change(function(){this.checked&&($("#billing-address-container").show(),$("#selected-billing-address").hide(),$("#billing-address-autocomplete").hide(),$("#chk-billing-manual-address-input-container").hide())}),$("input[name='chk-shipping-manual-address-input']").change(function(){this.checked&&($("#shipping-address-container").show(),$("#selected-shipping-address").hide(),$("#shipping-address-autocomplete").hide(),$("#chk-shipping-manual-address-input-container").hide())}),$("#shipping-address-container input, #shipping-address-container select").on("change",function(i){$("input[name='shipping-same-billing']").is(":checked")&&$("input[name='shipping-same-billing']").change()}),$("select[name='shipping-country'], input[name='shipping-city'], select[name='shipping-state'], select[name='shipping-province-canada'], input[name='shipping-province'], input[name='shipping-zip'], input[name='shipping-address'], input[name='shipping-address2']").on("change",function(i){var a,e=$("input[name='shipping-address']").val()+" "+$("input[name='shipping-address2']").val(),n=$("input[name='shipping-city']").val(),s=$("select[name='shipping-state']").val(),t=($("select[name='shipping-province-canada']").val(),$("input[name='shipping-province']").val(),$("input[name='shipping-zip']").val()),l=$("select[name='shipping-country']").val();$("#load_temps").load("checkout/inc_store_state_selection.asp",{state:s},function(i,e,a){}),setCurrency(),"USA"==l&&((a=$("#ajax-shipping-options")).load("/checkout/ajax_display_shipping_usps.asp",{country:"USA",zip:t,address:e,city:n,state:s},function(i){$("#shipping-loading").hide(),$.get("/checkout/ajax_display_shipping_ups.asp",{address:e,country:"USA",city:n,state:s,zip:t,add:"yes"},function(i,e){a.append(i),triggerShippingSelection(),calcAllTotals()})}),$("#shipping-province-canada, #billing-province-canada, #shipping-province, #billing-province").val(""),$("#shipping-province-canada, #shipping-province").prop("required",!1),$("#shipping-state").prop("required",!0),$(".shipping-province-canada").hide(),$(".billing-province-canada").hide(),$(".shipping-state").show(),$(".billing-state").show(),$(".shipping-province").hide(),$(".billing-province").hide(),$(".hide_inter_zip").hide(),$(".hide_usa_zip").show(),$(".customs-notice").hide()),"Canada"==l&&($("#ajax-shipping-options").load("/checkout/ajax_display_shipping_usps.asp",{country:"Canada"},function(){triggerShippingSelection(),calcAllTotals()}),$("#shipping-state, #billing-state, #shipping-province, #billing-province").val(""),$("#shipping-province-canada").prop("required",!0),$("#shipping-state, #shipping-province").prop("required",!1),$(".shipping-province-canada, .billing-province-canada, .hide_inter_zip, .customs-notice").show(),$(".shipping-state").hide(),$(".billing-state").hide(),$(".shipping-province").hide(),$(".billing-province").hide(),$(".hide_usa_zip").hide()),"USA"!=l&&"Canada"!=l&&($("#ajax-shipping-options").load("/checkout/ajax_display_shipping_usps.asp",{country:l},function(){triggerShippingSelection(),calcAllTotals()}),$("#shipping-state, #billing-state, #shipping-province-canada, #billing-province-canada").val(""),$("#shipping-state, #shipping-province-canada").prop("required",!1),$(".shipping-province-canada").hide(),$(".billing-province-canada").hide(),$(".shipping-state").hide(),$(".billing-state").hide(),$(".shipping-province").show(),$(".billing-province").show(),$(".hide_inter_zip").show(),$(".hide_usa_zip").hide(),$(".customs-notice").show()),verify_shipmethod_selected(),i.preventDefault()}),$("select[name='billing-country']").change(function(){var i=$("select[name='billing-country']").val();"USA"==i&&($(".billing-province-canada").hide(),$(".billing-state").show(),$(".billing-province").hide(),$(".hide_inter_zip").hide(),$(".hide_usa_zip").show(),$(".customs-notice").hide()),"Canada"==i&&($(".billing-province-canada").show(),$(".billing-state").hide(),$(".billing-province").hide(),$(".hide_inter_zip").show(),$(".hide_usa_zip").hide(),$(".customs-notice").show()),"USA"!=i&&"Canada"!=i&&($(".billing-province-canada").hide(),$(".billing-state").hide(),$(".billing-province").show(),$(".hide_inter_zip").show(),$(".hide_usa_zip").hide(),$(".customs-notice").show())}),$("#paypal").click(function(){$("#cash").prop("checked",!1)}),$("#cash").click(function(){$("#paypal").prop("checked",!1)}),$(document).on("click",".btn-group label, .shipping-method",function(){var i=$(this).attr("data-type");$("."+i+" .btn-selected").html(""),$(".btn-selected",this).html('<i class="ml-2 fa fa-lg fa-check"></i>')}),$("#cash").click(function(){$("#cash").is(":checked")?(toggleRequiredBillingFalse(),$(".billing-input-fields").fadeOut(1e3),$("#credit_card_inputs").fadeOut(1e3)):(toggleRequiredBillingTrue(),$(".billing-input-fields").fadeIn(1e3),$("#credit_card_inputs").fadeIn(1e3))}),$("#cim_cash_click").click(function(){toggleRequiredBillingFalse(),$(".billing-input-fields").fadeOut(1e3),$("#credit_card_inputs").fadeOut(1e3)}),$("#cardNumber").keyup(function(){$("#cardType").html=GetCardType($("#cardNumber").val())}),$("#checkout-newsletter-signup").on("click",function(){$("#checkout-newsletter-signup").is(":checked"),$.ajax({method:"post",dataType:"json",url:"/klaviyo/klaviyo-subscribe-newsletter.asp?email="+$("#e-mail").val()})}),$(document).on("click","#btn-edit-shipping-address",function(){$("#selected-shipping-address").hide(),$("#shipping-address-autocomplete").hide(),$("#shipping-address-container").show()}),$(document).on("click","#btn-edit-billing-address",function(){$("#selected-billing-address").hide(),$("#billing-address-autocomplete").hide(),$("#billing-address-container").show()}),$(document).ready(function(){$.getJSON("https://pro.ip-api.com/json/?key=1FbdfMEofSriXRs&fields=countryCode",function(){}).done(function(i){"US"!=i.countryCode&&"CA"!=i.countryCode&&($("#selected-shipping-address").hide(),$("#selected-billing-address").hide(),$("#shipping-address-autocomplete").hide(),$("#billing-address-autocomplete").hide(),$("#shipping-address-container").show(),$("#billing-address-container").show(),$("#chk-shipping-manual-address-input-container").hide(),$("#chk-billing-manual-address-input-container").hide())})});